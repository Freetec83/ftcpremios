<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Reserva de Números da Rifa</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  h1 { color: #333; }
  table { border-collapse: collapse; margin: 10px 0; }
  td {
    border: 1px solid #aaa; padding: 10px; width: 40px; text-align: center;
    cursor: pointer; user-select: none;
  }
  td.disponivel { background-color: #b8f2b8; }
  td.reservado { background-color: #f2b8b8; cursor: not-allowed; }
  td.selecionado { border: 3px solid #007700; }
  form { margin-top: 20px; max-width: 300px; }
  label { display: block; margin: 8px 0 3px; }
  input[type="text"], input[type="email"], input[type="tel"] {
    width: 100%; padding: 6px; box-sizing: border-box;
  }
  button { margin-top: 15px; padding: 10px 20px; background: #007700; color: white; border: none; cursor: pointer;}
  button:disabled { background: #aaa; cursor: not-allowed; }
  #mensagem { margin-top: 15px; font-weight: bold; }
</style>
</head>
<body>

<h1>Escolha o número da sua rifa</h1>
<table id="gridNumeros">
  <!-- Números vão aqui -->
</table>

<form id="formReserva" onsubmit="return reservarNumero()">
  <input type="hidden" id="numeroSelecionado" />
  <label for="nome">Nome:</label>
  <input type="text" id="nome" required />
  <label for="email">E-mail:</label>
  <input type="email" id="email" required />
  <label for="telefone">Telefone:</label>
  <input type="tel" id="telefone" pattern="^\\d{10,11}$" placeholder="Somente números (10-11 dígitos)" required />
  <button type="submit" disabled>Reservar Número</button>
</form>

<div id="mensagem"></div>

<script>
  const totalNumeros = 50;
  const numerosReservados = new Set([3, 7, 15]); // Exemplo: números já reservados
  let numeroSelecionado = null;

  const grid = document.getElementById('gridNumeros');
  const btnReservar = document.querySelector('button[type=submit]');
  const mensagem = document.getElementById('mensagem');
  const inputNumero = document.getElementById('numeroSelecionado');

  // Criar tabela de números dinamicamente
  function criarTabela() {
    let html = '';
    for (let i = 1; i <= totalNumeros; i++) {
      const classe = numerosReservados.has(i) ? 'reservado' : 'disponivel';
      html += `<td class="${classe}" data-num="${i}">${i}</td>`;
      if (i % 10 === 0) html += '</tr><tr>';
    }
    grid.innerHTML = '<tr>' + html + '</tr>';
  }

  // Lidar com clique no número
  grid.addEventListener('click', event => {
    if (event.target.tagName !== 'TD') return;
    if (event.target.classList.contains('reservado')) return;
    
    const n = +event.target.dataset.num;
    if (numeroSelecionado === n) {
      event.target.classList.remove('selecionado');
      numeroSelecionado = null;
      inputNumero.value = '';
      btnReservar.disabled = true;
    } else {
      // limpar seleção anterior
      grid.querySelectorAll('.selecionado').forEach(td => td.classList.remove('selecionado'));
      event.target.classList.add('selecionado');
      numeroSelecionado = n;
      inputNumero.value = n;
      btnReservar.disabled = false;
    }
    mensagem.textContent = '';
  });

  // Validar telefone simples (só números e tamanho 10 ou 11)
  function validarTelefone(tel) {
    return /^d{10,11}$/.test(tel);
  }

  // Reservar número (simulação)
  function reservarNumero() {
    if (!numeroSelecionado) {
      mensagem.textContent = 'Selecione um número antes de reservar.';
      return false;
    }
    const nome = document.getElementById('nome').value.trim();
    const email = document.getElementById('email').value.trim();
    const telefone = document.getElementById('telefone').value.trim();
    if (!validarTelefone(telefone)) {
      mensagem.textContent = 'Telefone inválido. Use apenas números (10 ou 11 dígitos).';
      return false;
    }
    // Simular reserva
    numerosReservados.add(numeroSelecionado);
    // Atualizar visual
    criarTabela();
    // Reset form
    document.getElementById('formReserva').reset();
    numeroSelecionado = null;
    btnReservar.disabled = true;
    mensagem.textContent = `Número reservado com sucesso para ${nome}!`;
    return false; // evitar reload da página
  }

  criarTabela();
</script>

</body>
</html>
