<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>FTC Pr√™mios ‚Äî Rifa</title>
<style>
:root{
  --bg:#060607;
  --panel:#0f1013;
  --accent:#d4af37;
  --muted:#9aa4b2;
  --paid:#16c784;
  --reserved:#d4af37;
  --free:#6b7280;
}
body{
  margin:0;
  background:var(--bg);
  color:white;
  font-family:Arial,Helvetica,sans-serif;
  display:flex;
  flex-direction:column;
  align-items:center;
}
header{
  text-align:center;
  margin-top:2rem;
  margin-bottom:1rem;
}
header h1{
  color:var(--accent);
  font-size:1.8rem;
  margin:0;
}
header h2{
  color:#fff;
  font-weight:normal;
  margin:0.3rem 0 0.8rem;
}
.stats{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:1rem;
  font-size:0.95rem;
  margin-bottom:1rem;
}
.stats span{display:flex;align-items:center;gap:4px;}
.stats .paid{color:var(--paid);}
.stats .reserved{color:var(--reserved);}
.stats .free{color:var(--free);}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(60px,1fr));
  gap:8px;
  max-width:500px;
  margin:1rem;
}
.number{
  padding:0.7rem;
  border-radius:8px;
  background:var(--panel);
  color:white;
  text-align:center;
  cursor:pointer;
  font-weight:bold;
  transition:0.2s;
}
.number.free:hover{background:#1f2126;}
.number.paid{background:var(--paid);}
.number.reserved{background:var(--reserved);color:#000;}
footer{
  color:var(--muted);
  text-align:center;
  font-size:0.8rem;
  margin:2rem 0;
}
</style>
</head>
<body>
  <header>
    <h1>üèÜ FTC Pr√™mios</h1>
    <h2 id="raffleInfo">Carregando rifa...</h2>
    <div class="stats">
      <span class="paid">üí∞ Pagos: <b id="paidCount">0</b></span>
      <span class="reserved">‚≠ê Reservados: <b id="reservedCount">0</b></span>
      <span class="free">‚ö™ Livres: <b id="freeCount">0</b></span>
    </div>
  </header>

  <div id="numbers" class="grid"></div>

  <footer>
    <p>Atualizado automaticamente a cada 20 segundos</p>
  </footer>

<script>
const WEB_APP_BASE = "https://script.google.com/macros/s/AKfycbyKZOzLcYMTGCFVokdvdLw7xirI80swAM6tancoXbYlLcELxVOAQYMKcgT2r7WM52N1/exec";

// L√™ o par√¢metro ?sheet=Rifa001 etc.
function getSheetParam(){
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get("sheet") || "Rifa001";
}

async function loadRaffle(){
  const sheet = getSheetParam();
  const url = `${WEB_APP_BASE}?sheet=${sheet}`;
  const res = await fetch(url);
  const data = await res.json();

  // Atualiza t√≠tulo e data
  const raffleName = data.title || sheet;
  const sorteio = data.sorteio ? `‚Äî Sorteio: ${data.sorteio}` : "";
  document.getElementById("raffleInfo").textContent = `${raffleName} ${sorteio}`;
  
  // Mostra n√∫meros
  const container = document.getElementById("numbers");
  container.innerHTML = "";

  let paid = 0, reserved = 0, free = 0;
  data.items.forEach(item=>{
    const div = document.createElement("div");
    const status = (item.STATUS || "Livre").toLowerCase();
    div.className = `number ${status}`;
    div.textContent = String(item.N√öMERO).padStart(2,"0");
    container.appendChild(div);

    if(status.includes("pago")) paid++;
    else if(status.includes("reserv")) reserved++;
    else free++;
  });

  // Atualiza contadores
  document.getElementById("paidCount").textContent = paid;
  document.getElementById("reservedCount").textContent = reserved;
  document.getElementById("freeCount").textContent = free;
}

// Atualiza a cada 20 s
loadRaffle();
setInterval(loadRaffle, 20000);
</script>
</body>
</html>
