<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Reserva de Número - Rifa Online</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; }
    label { display: block; margin-top: 10px; }
    input, button { width: 100%; padding: 10px; margin-top: 5px; }
    button { background-color: #4CAF50; color: white; border: none; cursor: pointer; }
    button:hover { background-color: #45a049; }
    .mensagem { margin-top: 15px; font-weight: bold; }
  </style>
</head>
<body>

<h2>Reservar Número na Rifa</h2>

<form id="formReserva">
  <label for="numero">Número (00 a 99):</label>
  <input type="number" id="numero" name="numero" min="0" max="99" required />

  <label for="nome">Nome Completo:</label>
  <input type="text" id="nome" name="nome" required />

  <label for="email">E-mail:</label>
  <input type="email" id="email" name="email" required />

  <label for="telefone">Telefone:</label>
  <input type="tel" id="telefone" name="telefone" required />

  <button type="submit">Reservar</button>
</form>

<div class="mensagem" id="mensagem"></div>

<script>
  const form = document.getElementById('formReserva');
  const mensagem = document.getElementById('mensagem');

  form.addEventListener('submit', e => {
    e.preventDefault();
    mensagem.textContent = 'Enviando reserva...';

    const dados = {
      numero: form.numero.value,
      nome: form.nome.value,
      email: form.email.value,
      telefone: form.telefone.value,
      status: 'reservado',
      codigoVenda: 'RIF' + form.numero.value + '-' + Date.now().toString(36).toUpperCase(),
      timestamp: Date.now()
    };

    fetch('https://script.google.com/macros/s/AKfycbzmIhPOWfRr9lWw-3X9tLZ8CBN6n2_0Ud_-E72hsI2bvqzCcF9bJK_a7iRI-NsvJyXm/exec', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(dados)
    })
    .then(res => res.json())
    .then(res => {
      if(res.result === 'success'){
        mensagem.textContent = 'Reserva realizada com sucesso! Código: ' + dados.codigoVenda;
        form.reset();
      } else {
        mensagem.textContent = 'Erro na reserva: ' + (res.message || 'tente novamente');
      }
    })
    .catch(() => {
      mensagem.textContent = 'Erro de comunicação com o servidor.';
    });
  });
</script>

</body>
</html>
