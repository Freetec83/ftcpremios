<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FTC Prêmios - Rifa Online</title>
<style>
  :root {
    --bg: #f3f6fb;
    --card: #ffffff;
    --accent: #0b66ff;
    --accent-dark: #084bcf;
    --muted: #6b7280;
    --available: #d1d5db;
    --reserved: #cfe8ff;
    --paid: #0b4fd6;
  }
  body {
    margin: 0; font-family: system-ui, Segoe UI, Roboto, Arial;
    background: var(--bg);
    color: #0b1220;
    padding: 14px;
  }
  .wrap {
    max-width: 1100px;
    margin: 14px auto;
  }
  header {
    display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;
  }
  h1 {
    margin: 0; font-size: 1.3rem; color: var(--accent-dark);
  }
  .sub {
    color: var(--muted); font-size: 0.95rem;
  }
  #numbersTable {
    width: 100%; border-collapse: collapse; margin: 8px 0; cursor: pointer;
  }
  #numbersTable td {
    border: 1px solid rgba(10, 20, 40, 0.04); padding: 10px; text-align: center; border-radius: 6px; font-weight: 700; user-select: none;
  }
  .cell-available {
    background: var(--available);
  }
  .cell-reserved {
    background: var(--reserved);
    cursor: not-allowed;
  }
  .cell-paid {
    background: var(--paid);
    color: white;
    cursor: not-allowed;
  }
  footer {
    text-align: center; margin-top: 20px; font-weight: bold; color: var(--muted);
  }
  img.qr {
    display: block; margin: 14px auto; border: 2px solid var(--accent); border-radius: 12px;
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>FTC Prêmios</h1>
        <div class="sub">Rifa pública 00–99 — sincronizada com painel do organizador</div>
      </div>
    </header>

    <img src="Screenshot_20251031_181234.jpg" alt="QR Code Pix" width="200" height="200" class="qr" />

    <p style="text-align:center; font-weight:bold;">...O próximo movimento pode ser o seu grande ganho !!!</p>

    <table id="numbersTable" aria-label="Tabela de números"></table>

    <footer>...O próximo movimento pode ser o seu grande ganho !!!</footer>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "SUA_API_KEY",
      authDomain: "SEU_PROJETO.firebaseapp.com",
      projectId: "SEU_PROJETO",
      storageBucket: "SEU_PROJETO.appspot.com",
      messagingSenderId: "SEU_MESSAGING_SENDER_ID",
      appId: "SEU_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);

    const db = firebase.firestore();
    const ticketsCol = db.collection('tickets');

    const maxNumber = 99;
    const ticketPrice = 10;
    const numbersTable = document.getElementById('numbersTable');

    let tickets = [];

    function render() {
      let html = '<tr>';
      tickets.forEach((ticket, idx) => {
        let className = 'cell-available';
        if (ticket.status === 'reserved') className = 'cell-reserved';
        else if (ticket.status === 'paid') className = 'cell-paid';

        html += `<td class="${className}">${ticket.number}</td>`;
        if ((idx + 1) % 10 === 0) html += '</tr><tr>';
      });
      html += '</tr>';
      numbersTable.innerHTML = html;
    }

    ticketsCol.onSnapshot(snap => {
      tickets = [];
      snap.forEach(doc => tickets.push(doc.data()));
      for (let i = 0; i <= maxNumber; i++) {
        const num = i.toString().padStart(2, '0');
        if (!tickets.find(t => t.number === num)) {
          tickets.push({ number: num, status: 'available' });
        }
      }
      tickets.sort((a, b) => a.number.localeCompare(b.number));
      render();
    }, err => {
      console.error('Erro loading tickets:', err);
    });

    numbersTable.addEventListener('click', async e => {
      if (e.target.tagName !== 'TD') return;
      const number = e.target.textContent;
      const ticket = tickets.find(t => t.number === number);
      if (!ticket || ticket.status !== 'available') {
        alert('Número indisponível para reserva.');
        return;
      }
      const name = prompt(`Digite seu nome para reservar o número ${number}:`);
      if (!name) return alert('Reserva cancelada.');
      try {
        await ticketsCol.doc(number).set({
          number,
          status: 'reserved',
          name
        }, { merge: true });
        alert(`Número ${number} reservado com sucesso para ${name}!`);
      } catch (err) {
        console.error(err);
        alert('Erro ao reservar número. Tente novamente.');
      }
    });
  </script>
</body>
</html>
