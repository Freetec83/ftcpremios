<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RIFA N¬∫</title>
<style>
:root {
  --bg: #060607;
  --panel: #0f1013;
  --accent: #d4af37;
  --muted: #9aa4b2;
  --paid: #16c784;
  --unpaid: #444;
}
body {
  background: var(--bg);
  color: #fff;
  font-family: "Segoe UI", sans-serif;
  margin: 0;
  padding: 0;
  text-align: center;
}
header {
  background: var(--panel);
  padding: 1rem;
  color: var(--accent);
  font-size: 1.5rem;
  font-weight: bold;
  letter-spacing: 1px;
}
#numbers {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
  gap: .5rem;
  padding: 1rem;
  max-width: 600px;
  margin: auto;
}
.number {
  border: 1px solid var(--accent);
  border-radius: 8px;
  padding: .7rem 0;
  font-weight: bold;
  cursor: pointer;
  transition: .2s;
}
.number:hover { background: var(--accent); color: #000; }
.number.paid { background: var(--paid); color: #000; border-color: var(--paid); cursor: not-allowed; }
#info {
  background: var(--panel);
  padding: .5rem;
  margin-top: .5rem;
  font-size: .9rem;
  color: var(--muted);
}
button {
  background: var(--accent);
  color: #000;
  border: none;
  border-radius: 8px;
  padding: .5rem 1rem;
  font-weight: bold;
  cursor: pointer;
  transition: .2s;
}
button:hover { opacity: 0.8; }

/* Painel organizador */
#organizerPanel {
  display: none;
  background: var(--panel);
  color: var(--accent);
  padding: 1rem;
  border-top: 2px solid var(--accent);
}
#drawArea {
  margin-top: 1rem;
  font-size: 1.2rem;
  color: var(--accent);
}
input, textarea {
  background: #111;
  color: #fff;
  border: 1px solid var(--accent);
  border-radius: 6px;
  padding: .3rem;
  margin: .2rem 0;
}
</style>
</head>
<body>
<header>RIFA N¬∫</header>

<div id="info">
  Valor do n√∫mero: <b>R$10,00</b> | Pr√™mio: <b>70% do total vendido</b>
</div>

<div id="numbers"></div>

<p><button onclick="openWhatsApp()">Ir para pagamento via WhatsApp</button></p>

<p><button onclick="openOrganizer()">Painel Organizador</button></p>

<div id="organizerPanel">
  <h3>PAINEL DE VENDAS DA RIFA N¬∫</h3>
  <p>DATA DO SORTEIO: <input type="date" id="sorteioData"> HOR√ÅRIO: <input type="time" id="sorteioHora"></p>
  <p>VENCEDOR(A): <input type="text" id="winnerName" placeholder="Preencha ap√≥s sorteio"></p>
  <p><b>Total vendido:</b> R$<span id="totalSold">0</span></p>
  <button onclick="startDraw()">Iniciar Sorteio (30s)</button>
  <div id="drawArea"></div>
  <hr>
  <table border="1" style="width:100%; border-color:var(--accent); color:#fff; font-size:.9rem;">
    <thead>
      <tr><th>N√öMERO</th><th>STATUS</th><th>E-MAIL</th><th>TELEFONE</th><th>C√ìDIGO DE VENDA</th></tr>
    </thead>
    <tbody id="salesTable"></tbody>
  </table>
</div>

<script>
const TOTAL_NUMBERS = 51;
const PRICE = 10;
const PASSWORD = "8378";
const whatsappLink = "https://chat.whatsapp.com/BnJBwDm5C0D5t2wiB6K0NC?mode=wwt";

let sales = JSON.parse(localStorage.getItem('rifaSales') || '{}');

function renderNumbers() {
  const container = document.getElementById('numbers');
  container.innerHTML = '';
  for (let i = 0; i < TOTAL_NUMBERS; i++) {
    const num = i.toString().padStart(2, '0');
    const div = document.createElement('div');
    div.className = 'number' + (sales[num]?.paid ? ' paid' : '');
    div.textContent = num;
    div.onclick = () => selectNumber(num);
    container.appendChild(div);
  }
  updateTotal();
  renderTable();
}

function selectNumber(num) {
  if (sales[num]?.paid) return alert('Este n√∫mero j√° foi pago!');
  const email = prompt('Digite seu e-mail:');
  const tel = prompt('Digite seu telefone:');
  sales[num] = { paid: false, email, tel, code: '' };
  saveSales();
  alert('N√∫mero reservado! V√° ao grupo do WhatsApp para confirmar o pagamento.');
  openWhatsApp();
  renderNumbers();
}

function openWhatsApp() { window.open(whatsappLink, '_blank'); }

function openOrganizer() {
  const pass = prompt('Digite a senha do organizador:');
  if (pass === PASSWORD) {
    document.getElementById('organizerPanel').style.display = 'block';
  } else alert('Senha incorreta!');
}

function saveSales() {
  localStorage.setItem('rifaSales', JSON.stringify(sales));
}

function updateTotal() {
  const total = Object.values(sales).filter(s => s.paid).length * PRICE;
  document.getElementById('totalSold').textContent = total;
}

function renderTable() {
  const tbody = document.getElementById('salesTable');
  tbody.innerHTML = '';
  Object.keys(sales).forEach(num => {
    const s = sales[num];
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${num}</td>
      <td>${s.paid ? 'Pago' : 'Pendente'}</td>
      <td>${s.email || ''}</td>
      <td>${s.tel || ''}</td>
      <td>${s.code || ''}</td>`;
    tr.onclick = () => togglePaid(num);
    tbody.appendChild(tr);
  });
}

function togglePaid(num) {
  if (!confirm(`Alterar status do n√∫mero ${num}?`)) return;
  const s = sales[num];
  s.paid = !s.paid;
  s.code = s.paid ? Math.random().toString(36).substring(2,8).toUpperCase() : '';
  saveSales();
  renderNumbers();
}

function startDraw() {
  const paidNumbers = Object.keys(sales).filter(n => sales[n].paid);
  if (paidNumbers.length === 0) return alert('Nenhum n√∫mero pago.');
  let counter = 30;
  const area = document.getElementById('drawArea');
  area.textContent = "Sorteando em 30 segundos...";
  const timer = setInterval(() => {
    counter--;
    area.textContent = "Sorteando em " + counter + " segundos...";
    if (counter <= 0) {
      clearInterval(timer);
      const winner = paidNumbers[Math.floor(Math.random() * paidNumbers.length)];
      document.getElementById('winnerName').value = "N¬∫ " + winner;
      area.innerHTML = "<h2>üéâ N√∫mero sorteado: " + winner + " üéâ</h2>";
    }
  }, 1000);
}

renderNumbers();
</script>
</body>
</html>
